name: Styling
dials:
  max_depth: 7
  form: 42
hooks:

  T_end: |
    my $t = $G->{_trail} ||= [];
    my $xL = $L; 
    
    my $yL = $xL->{t};
    my ($ytw, $ylw) = ([],[]);
    for my $yw (@{$yL->{o}}) {
        if ($yw->{Li}) {
            push @$ytw, $yw
        }
        else {
            push @$ylw, $yw
        }
    }
    my $yiw = $yL->{i};
    my $xiw = $xL->{i};
    
    my $xso = $xiw->{x};
    my $xs = {};
    
    my $xt;
    for my $ya (['l',$ylw],['t',$ytw]) {
        my ($y,$yww) = @$ya;
        for my $w (@$yww) {
            push @{$xt->{l}||=[]}, "$y ". $w->pint;
        }
    }
    
    push @$t, $xt;
    push @$t, {
        xLDepth => join("",("..")x$xL->{depth}),
        yLi =>  (ref $yL->{i} eq "Way" ? $yL->{i}->pint : "iww!www: $yL->{i}"),
        yLt => $yL->{t},
        yL => $yL,
    } if 0;
    
    # o[ s/...
    # (re)make i s...

    return unless $xL->{depth} == 0;
        
    my $html = "HTML!";
    
    @$r = $html;
    
    $t = {
        t => $t,
        G => $G->{name},
    };
    $G->timer(0.2, sub {
        $O->{O}->w(somewhere=>{thing=>$t,max_depth=>3});
    },"bailout");
   

