
name: the sky
hooks:
  fresh_init: |
    # w< ...etc?
    G TT ->G("H/colour");
    w colours;
    w ambientness;
  recoded_init: |
      w doof;
      $G->{db} = 1;
      $H->timer(0.1, sub {
          $L->w(  somewhere => {thing => $G->stackway} ) 
      });
  doof: |
    $H->JS($H->{sky},"stop()");
    w colourchange(t=>200, c => '333');
    w touch; 
  ambientness: |
    w colourchange(t=>15000);
    timer 19 { w ambientness };
  colours: |
    $G->{colours} = [ shuffle '77a9a0','6699cF','3366cF',
    '6699cc','005F6B',
    '86999F','4C3380',
    '336699','8F00B2',
    '336aa9','72a699','6B8FB2'];
  colourchange: |
    $ar->{t} ||= 5000;
    $ar->{c} ||= w rotate_colourwheel;
    $H->JS($H->{sky},"animate({backgroundColor: '#$ar->{c}'}, $ar->{t});");
  getundercontrol: |
    $H->JS("\$('#mess').toggleClass('widdle').animate({'max-width': '26%'});");
  touch: |
    if (eval { $ar->{e}->[1]->{C} }) {
        w getundercontrol;
    }
    if (eval { $ar->{e}->[1]->{S} }) {
        Gf colour Tw change_person(name => "sky");
    }
    $@ = "";
  
    $ar->{t} ||= 1000;
    w colourchange;
  rotate_colourwheel: |
    $G->{colours} || w colours;
    my $c = shift @{$G->{colours}};
    push @{$G->{colours}}, $c;
    #return G colour Tw randomcolour(name => "sky");
    return $c;
    

